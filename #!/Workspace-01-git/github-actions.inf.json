#!/usr/bin/env inf
{
    "# echo": "[WSS:Workspace:01] Configuring Github Actions.",

    "#": "gi0.PINF.it/core/v0",
    "#": {
        "/.~/gi0.Sourcemint.org~sm.act/workflows": "sm.act"
    },

    ":github.actions:": "/.~/gi0.Sourcemint.org~sm.act/workflows @ github.com/actions/v0",

    "gi0.PINF.it/build/v0 @ # /": (inf () >>>
        {
            "ENV # if() --reset w01": (inf () >>>
                {
                    "# echo": "[WSS:Workspace:01] Resetting Workspace Level 01 (git)",

                    "# run": (run.bash.progress (ENV) >>>

                        # TODO: Relocate to 'sm.act'

                        echo "[WSS:Workspace:01] Resetting 'sm' branch and cache."

                        if [ -e ".~/gi0.Sourcemint.org~sm/branch" ]; then
                            pushd ".~/gi0.Sourcemint.org~sm/branch" > /dev/null
                                git push "sm" --delete sm/master || true
                            popd > /dev/null
                            rm -Rf ".~/gi0.Sourcemint.org~sm"*
                        fi
                    <<<)
                }
            <<<),
            "gi0.PINF.it/build/v0 @ # :github.actions: workflow() /.~/gi0.Sourcemint.org~sm.act/workflows/Workspace": (json () >>>
                {
                    "name": "Workspace",
                    "on": [
                        "push"
                    ],
                    "jobs": {
                        "Run": {
                            "runs-on": "ubuntu-latest",
                            "strategy": {
                                "matrix": {
                                    "node-version": [
                                        "12.x"
                                    ]
                                }
                            },
                            "steps": [
                                {
                                    "uses": "actions/checkout@v1"
                                },
                                {
                                    "name": "Run",
                                    "run": "./run.sh"
                                }
                            ]
                        }
                    }
                }
            <<<)
        }
    <<<)
}
